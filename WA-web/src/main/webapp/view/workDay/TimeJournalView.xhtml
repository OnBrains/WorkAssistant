<ui:composition template="/view/View.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:define name="header">
        <h:outputStylesheet name="wa-time.css"/>
        <title>Влияй на свое будущее</title>
    </ui:define>

    <ui:define name="body">

        <pe:layout>

            <pe:layoutPane position="north" closable="false" resizable="true" styleClassContent="layout_style">
                <p:menubar>
                    <p:submenu label="Справочники" id="directories_submenu">
                        <p:menuitem value="Типы событий" url="/view/event/EventTypesDirectory.xhtml"/>
                    </p:submenu>
                    <f:facet name="options">
                        <h:outputText value="#{loginViewModel.worker.toString()}"/>
                        <p:commandButton value="Выйти" action="#{loginViewModel.logout}" icon="ui-icon-extlink"/>
                    </f:facet>
                </p:menubar>
            </pe:layoutPane>

            <pe:layoutPane position="west" closable="true" resizable="false" size="450" minSize="450"
                           styleClassContent="layout_style">
                <ui:include src="/view/workDay/CurrentDayFrame.xhtml"/>
            </pe:layoutPane>

            <pe:layoutPane position="center" resizable="true" styleClassContent="layout_style">
                <h:form id="month_statistic">
                    <p:outputPanel styleClass="panel_for_statistic">
                        <ul id="list_with_legend" style="display: #{workDayViewModel.selectedMonth != null ? 'table' : 'none'};">
                            <li style="#{workDayViewModel.statistic.workedTime == 0 ? 'display: none' : ''};">
                                <div class="circle" style="background-color: #4da9f1;"/>
                                #{dateFormat.mSecToHHMM(workDayViewModelOld.statistic.workedTime)} Отработано
                            </li>
                            <li style="#{workDayViewModel.statistic.deltaTime == 0 ? 'display: none' : ''};">
                                <div class="circle" style="background-color: #{workDayViewModel.statistic.realWorkedTimeMoreIdeal ? 'green' : 'red'};"/>
                                #{dateFormat.mSecToHHMM(workDayViewModel.statistic.deltaTime)}
                                #{workDayViewModel.statistic.realWorkedTimeMoreIdeal ? 'Переработок' : 'Недоработок'}
                            </li>
                            <li style="#{workDayViewModel.statistic.remainingTime == 0 ? 'display: none' : ''};">
                                <div class="circle" style="background-color: chocolate;"/>
                                #{dateFormat.mSecToHHMM(workDayViewModel.statistic.remainingTime)} Осталось
                            </li>
                        </ul>
                    </p:outputPanel>

                    <div style="display: #{workDayViewModel.selectedMonth != null ? 'table' : 'none'}; width: 100%;">
                        <span style="#{workDayViewModel.getStyleForWorkedTime()}"/>
                        <span style="#{workDayViewModel.getStyleForDeltaTime()}"/>
                        <span style="#{workDayViewModel.getStyleForRemainingTime()}"/>
                    </div>
                </h:form>
                <h:form id="month_action">
                    <p:outputPanel style="height: 43px;">
                        <p:commandButton id="create_days_for_month" value="+"
                                         action="#{workDayViewModel.createWorkDaysForSelectedMonth}"
                                         rendered="#{workDayViewModel.workDaysBySelectedMonth.size() == 0}"
                                         style="float:left; margin: 10px;" update=":month_info_form, :month_statistic"/>
                        <p:commandButton value="Событие" style="float:right; margin: 10px;"
                                         title="Данная функция еще не реализована"/>
                    </p:outputPanel>
                </h:form>
                <h:form id="month_info_form">
                    <p:dataTable id="month_info_table" value="#{workDayViewModel.workDaysBySelectedMonth}" var="dayInfo"
                                 rowStyleClass="#{workDayViewModelOld.getStyleClassForRow(dayInfo)}" editable="true"
                                 scrollable="true" scrollHeight="700">
                        <f:facet name="header">
                            <p:commandButton id="previous_month" value="#{workDayViewModel.nameForPreviousMonth}"
                                             action="#{workDayViewModel.previousMonth}"
                                             update=":month_info_form, :month_statistic, :month_action"
                                             style="float: left; margin: 5px;"/>
                            <h:outputText value="#{dateFormat.toMMMMMYYYY(workDayViewModel.selectedMonth.time)}"
                                          style="vertical-align: -webkit-baseline-middle;"/>
                            <p:commandButton id="next_month" value="#{workDayViewModel.nameForNextMonth}"
                                             action="#{workDayViewModel.nextMonth}"
                                             update=":month_info_form, :month_statistic, :month_action"
                                             style="float: right; margin: 5px;"/>
                        </f:facet>
                        <p:column headerText="Тип дня">
                            <h:outputText value="#{dayInfo.day.type.desc}"/>
                        </p:column>
                        <p:column headerText="День" style="text-align: center;">
                            <h:outputText value="#{dateFormat.toDDEE(dayInfo.day.day)}"/>
                        </p:column>
                        <p:column id="start_work_day_id" style="text-align: center; width: 10%;">
                            <f:facet name="header">
                                <h:graphicImage name="img/clock/clock_play.png" title="Начало рабочего дня"/>
                            </f:facet>
                            <h:outputText value="#{dateFormat.toHHMM(dayInfo.comingTime.time)}"/>
                        </p:column>
                        <p:column id="end_work_day_id" style="text-align: center; width: 10%">
                            <f:facet name="header">
                                <h:graphicImage name="img/clock/clock_stop.png" title="Окончание рабочего дня"/>
                            </f:facet>
                            <h:outputText value="#{dateFormat.toHHMM(dayInfo.outTime.time)}"/>
                        </p:column>
                        <p:column id="summary_work_day_id" style="text-align: center; width: 10%;">
                            <f:facet name="header">
                                <h:graphicImage name="img/clock/clock_link.png" title="Отработанное время"/>
                            </f:facet>
                            <h:outputText value="#{dateFormat.mSecToHHMM(dayInfo.getSummaryWorkedTime())}"/>
                        </p:column>
                        <p:column id="delta_work_day_id" style="text-align: center; width: 10%;">
                            <f:facet name="header">
                                <h:graphicImage name="img/clock/clock_add.png" title="Переработано/Недоработано"/>
                            </f:facet>
                            <h:outputText value="#{dateFormat.mSecToHHMM(dayInfo.getDeltaTime())}"/>
                        </p:column>
                        <p:column id="state_work_day_id" headerText="Состояние" style="text-align: center; width: 25%;">
                            <h:outputText value="#{dayInfo.state.desc}"/>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </pe:layoutPane>

            <pe:layoutPane position="south" closable="false" resizable="false" styleContent="text-align: center"
                           styleClassContent="layout_style">
                <p:graphicImage name="img/iconNC.png"/>
            </pe:layoutPane>

        </pe:layout>

    </ui:define>

</ui:composition>